<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Write unit and integration tests for Node.js and Express projects using Mocha, Chai and Chai-http." />
    <meta name="author" content="Elle Townsend" /><meta property="og:description" content="Write unit and integration tests for Node.js and Express projects using Mocha, Chai and Chai-http." />
    <meta property="og:image" content="https://images.unsplash.com/photo-1602409202405-f71d55856381?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=3150&q=80" />

    <meta name="twitter:site" content="@_elletownsend" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Integration & Unit Testing For¬†Node.js | Elle Townsend" />
    <meta name="twitter:description" content="Write unit and integration tests for Node.js and Express projects using Mocha, Chai and Chai-http." />
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1602409202405-f71d55856381?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=3150&q=80" />

    <title>Integration & Unit Testing For¬†Node.js | Elle Townsend</title>

    <link rel="stylesheet" href="/build/main.css" />

    <!-- Custom fonts -->
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
</head>

<body class="light-mode" id="body">
    <nav class="nav" id="nav">
        <a class="toggle" href="javascript:void(0);" onclick="toggleDarkMode()" aria-label="Dark Mode Toggle"><svg width="59" height="48" viewBox="0 0 59 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M49.3335 22.6661H38.6668C37.9295 22.6661 37.3335 22.07 37.3335 21.3327C37.3335 20.5954 37.9295 19.9994 38.6668 19.9994H49.3335C50.0709 19.9994 50.6669 20.5954 50.6669 21.3327C50.6669 22.07 50.0709 22.6661 49.3335 22.6661Z" fill="#222222" />
                <path d="M33.3334 22.6661H30.6668C29.9294 22.6661 29.3334 22.07 29.3334 21.3327C29.3334 20.5954 29.9294 19.9994 30.6668 19.9994H33.3334C34.0708 19.9994 34.6668 20.5954 34.6668 21.3327C34.6668 22.07 34.0708 22.6661 33.3334 22.6661Z" fill="#222222" />
                <path d="M52.6669 5.33266C52.0589 5.33266 51.4509 5.42999 50.8642 5.62066C49.6455 3.79132 47.5935 2.66599 45.3335 2.66599C42.5002 2.66599 40.0668 4.44732 39.1148 6.97667C38.5468 6.77267 37.9455 6.666 37.3335 6.666C34.3921 6.666 32.0001 9.05801 32.0001 11.9994C32.0001 14.9407 34.3921 17.3327 37.3335 17.3327H52.6669C55.9749 17.3327 58.6669 14.6407 58.6669 11.3327C58.6669 8.02467 55.9749 5.33266 52.6669 5.33266ZM52.6669 14.666H51.2589C51.7175 13.878 52.0002 12.9754 52.0002 11.9994C52.0002 11.262 51.4042 10.666 50.6669 10.666C49.9295 10.666 49.3335 11.262 49.3335 11.9994C49.3335 13.47 48.1375 14.666 46.6668 14.666H37.3335C35.8628 14.666 34.6668 13.47 34.6668 11.9994C34.6668 10.5287 35.8628 9.33268 37.3335 9.33268C37.9895 9.33268 38.6268 9.58468 39.1268 10.042C39.5055 10.3927 40.0562 10.4887 40.5335 10.294C41.0108 10.098 41.3335 9.64468 41.3602 9.12734C41.4695 7.00067 43.2135 5.33266 45.3335 5.33266C46.9708 5.33266 48.4228 6.318 49.0375 7.84334C49.1828 8.20467 49.4802 8.48334 49.8495 8.60867C50.2175 8.73134 50.6269 8.69134 50.9589 8.48734C51.5015 8.16334 52.0762 7.99934 52.6669 7.99934C54.5055 7.99934 56.0002 9.49401 56.0002 11.3327C56.0002 13.1714 54.5055 14.666 52.6669 14.666Z" fill="#222222" />
                <path d="M53.8802 24.8727C53.3309 24.6234 52.6762 24.7794 52.2962 25.2514C49.1828 29.1101 44.5642 31.3221 39.6255 31.3221C30.6481 31.3221 23.3441 24.0181 23.3441 15.0407C23.3441 10.102 25.5561 5.48333 29.4148 2.36998C29.8868 1.98865 30.0428 1.33798 29.7934 0.785979C29.5428 0.233977 28.9561 -0.0806912 28.3561 0.0179758C17.3334 1.87132 9.33337 11.3287 9.33337 22.5047C9.33337 25.2167 9.83337 27.8074 10.7054 30.2221C7.92003 31.5341 5.88135 34.1794 5.42935 37.3341C5.39735 37.3328 5.36402 37.3328 5.33335 37.3328C2.39201 37.3328 0 39.7248 0 42.6661C0 45.6075 2.39201 47.9995 5.33335 47.9995H24.0001C26.4134 47.9995 28.5761 46.9208 30.0441 45.2248C30.7414 45.2901 31.4468 45.3328 32.1614 45.3328C43.3375 45.3328 52.7949 37.3328 54.6482 26.3101C54.7495 25.7127 54.4335 25.1221 53.8802 24.8727ZM24.0001 45.3328H12C10.5294 45.3328 9.33337 44.1368 9.33337 42.6661C9.33337 41.9288 8.73736 41.3328 8.00003 41.3328C7.26269 41.3328 6.66669 41.9288 6.66669 42.6661C6.66669 43.6421 6.94936 44.5448 7.40803 45.3328H5.33335C3.86268 45.3328 2.66668 44.1368 2.66668 42.6661C2.66668 41.1955 3.86268 39.9995 5.33335 39.9995C5.61469 39.9995 5.90935 40.0555 6.23202 40.1701C6.64802 40.3181 7.10669 40.2528 7.46536 39.9928C7.82269 39.7328 8.0267 39.3128 8.01336 38.8728C8.01203 38.8554 8.00136 38.6848 8.00003 38.6661C8.00003 34.9901 10.9907 31.9994 14.6667 31.9994C16.7974 31.9994 18.8161 33.0368 20.0694 34.7741C20.8681 35.8728 21.3334 37.2061 21.3334 38.6661C21.3334 39.4035 21.9294 39.9995 22.6667 39.9995C23.4041 39.9995 24.0001 39.4035 24.0001 38.6661C24.0001 37.2728 23.6788 35.9568 23.1281 34.7674C23.4188 34.7154 23.7081 34.6661 24.0001 34.6661C26.9414 34.6661 29.3334 37.0581 29.3334 39.9995C29.3334 42.9408 26.9414 45.3328 24.0001 45.3328ZM32.1614 42.6661C31.9534 42.6661 31.7508 42.6408 31.5441 42.6355C31.8348 41.8088 32.0001 40.9235 32.0001 39.9995C32.0001 35.5874 28.4121 31.9994 24.0001 31.9994C23.1774 31.9994 22.3614 32.1314 21.5667 32.3941C19.8081 30.4608 17.2987 29.3327 14.6667 29.3327C14.1867 29.3327 13.7187 29.3781 13.2587 29.4474C12.4587 27.2794 12 24.9474 12 22.5047C12 14.2527 16.9401 7.06067 24.2494 3.96999C21.9441 7.15934 20.6761 11.0073 20.6761 15.042C20.6761 25.4901 29.1761 33.9901 39.6241 33.9901C43.6575 33.9901 47.5068 32.7234 50.6962 30.4168C47.6055 37.7261 40.4148 42.6661 32.1614 42.6661Z" fill="#222222" />
            </svg></a>

        <a class="header_link" href="/index.html#contact" tabindex="4">contact</a>
        <a class="header_link" href="/index.html#work" tabindex="3">work</a>
        <a class="header_link" href="/blog/posts/index.html" tabindex="2">blog</a>
        <a class="header_link" href="/index.html" tabindex="1">home</a>

        <a class="hamb" href="javascript:void(0);" onclick="hideShowNav()" aria-label="Menu">
            <i class="fa fa-bars fa-2x"></i></a>
    </nav>
    <main class="blog_post">
        <a class="return" href="/blog/posts/index.html">&larr; back</a>
        <h1 class="blog_heading">Integration & Unit Testing For¬†Node.js</h1>
        <h2 class="blog_sub">A Beginner's guide to testing Node & Express projects using Mocha & Chai ‚òï</h2>
        <span class="date">Apr 10, 2021</span>
        <img class="featured_img" src="https://images.unsplash.com/photo-1602409202405-f71d55856381?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=3150&q=80" alt="Laptop on a bed next to a coffee.">
        <span class="img_caption">Photo by Sincerely Media on Unsplash</span>
        <div class="blog_content">
            <p>Software testing verifies that our code works as intended and meets the technical, functional, and user requirements that it needs to. Testing is a vital part of developing any software, but is so often overlooked by new engineers as an area to learn and develop their skills. It doesn't help that more often than not, it's hard to find good tutorials, guides or blog posts explaining the different kinds of tests for a code project, and how to actually write these tests.</p>
<p>To begin with, I wanted to go over some important words that pop up all the time around software testing, and what they mean:</p>
<p><strong>Unit Testing</strong>‚Ää-‚ÄäUnit testing is the testing of the smallest 'units' or components of a program. In most cases, the smallest unit under test would be a function. Therefore, in these situations, we are testing to make sure our individual functions work as expected.</p>
<p>Unit testing is performed before any other type of software testing, and it is usually the responsibility of the developer to conduct &amp; write these tests.</p>
<p><strong>Integration Testing</strong>‚Ää-‚ÄäIntegration testing is the testing of a combination of a related group of units of code that provide a given functionality. In this case, we are testing for bugs that can occur within the interactions between units.</p>
<p>Integration testing can also be the responsibility of a developer, but it's not uncommon to have independent testers to also get involved with integration testing.</p>
<p>In this example, we will go over unit and integration tests for a Node.Js &amp; Express API project. The main functionality of our example project will be responding to GET HTTP requests with a random number, this isn't too important, as the main focus will be on the tests.</p>
<hr>
<h2>Tools</h2>
<h3>Node.js &amp; Express¬†üî•</h3>
<p>We are going to be creating a simple Node.js application that uses the Express.js framework to create a mini-API. This is just for example purposes, and will act as the code under test.</p>
<p>For more information on both of these, please have a look at the <a href="https://nodejs.org/en/">Node.js</a> and <a href="https://expressjs.com">Express.js</a> documentation.</p>
<h3>Mocha ‚òïÔ∏è</h3>
<p>Mocha is a flexible, open-source JavaScript testing framework that runs on Node.js. It works for testing synchronous and asynchronous code, and nicely logs the test results to the console. Mocha can be used for both unit &amp; integration testing.</p>
<p>Mocha can be used alongside most <a href="https://stackoverflow.com/questions/25678063/whats-the-difference-between-assertion-library-testing-framework-and-testing-e/25678226#25678226">assertion libraries</a> (a tool that is in charge of the verification of your test results), but the most popular Node.js assertion library used with Mocha is called Chai.</p>
<h3>Chai &amp; Chai-http ü´ñ</h3>
<p>Chai is a Behaviour / Test driven design assertion library used frequently with Mocha in Node.js testing. Chai-http is a plugin for Chai that allows us to write HTTP integration tests with Chai.</p>
<p>The hot-beverage themed pair work together to create a great way to get started with testing our Node.js &amp; Express projects.</p>
<hr>
<h2>The Set¬†Up</h2>
<p>Requirements: <a href="https://nodejs.org/en/">Node.js installed.</a></p>
<p>In order to best demonstrate testing, we are going to need some code to test.</p>
<p><em>(If you're using this tutorial as a guide to testing an existing project‚Ää-‚Äägreat! You don't need to create this project, but the testing should follow the same principles.)</em></p>
<p>First things first, create a new Node.js project (create a new folder and run <code>npm init</code> from there). After this, go ahead and install express using <code>npm install express</code>.</p>
<p>Next, we will create our <code>server.js</code> file, which is going to hold all the logic for our example app:</p>
<script src="https://gist.github.com/elletownsend/39ad557db5ece243df95ec6a2d0119ec.js"></script>
<p>Our Node app listens at <code>localhost:3000</code> and exposes an endpoint <code>/random</code> that returns a random number. You can give it a try by running your app (<code>npm start</code>), and navigating to <code>localhost:3000</code> in your browser.</p>
<hr>
<h2>The Tests</h2>
<p>Now its time to test!</p>
<p>To set this up correctly, I'd advise that you create a <code>test</code> sub-folder to keep all your testing files for this app together.</p>
<p>Next up, we need to install our testing libraries by running:</p>
<pre><code>npm install mocha chai chai-http
</code></pre>
<p>And making sure that in our <code>package.json</code> we have added Mocha to our test script like so:</p>
<pre><code>...
  &quot;main&quot;: &quot;server.js&quot;,
  &quot;scripts&quot;: {
    &quot;start&quot;: &quot;node server.js&quot;,
    &quot;test&quot;: &quot;mocha&quot;
  },
  &quot;author&quot;: &quot;&quot;,
...
</code></pre>
<p>This means that now we only need to run <code>npm test</code> when we want to run our tests. We are now all set up and ready to write our first unit test.</p>
<h3>Unit Tests</h3>
<p>As mentioned earlier, unit testing is all about testing single, individual functions. In the case of our example code, we are going to write a unit test that checks that our <code>getRandom</code> function does what it's supposed to and generates a random whole number between 0 and 100.</p>
<p>We first have to require chai and chai.assert to get our assertion library. Then we describe the function under test, call that function, and make assertions on the result.</p>
<script src="https://gist.github.com/elletownsend/b4a7431c814656fac91ce0b09ab4fd49.js"></script>
<p>Here, the <code>describe</code> function encapsulates our test. The first argument is a string that describes what we are testing (for the sake of example, I have called it 'Unit Test', but it would be more descriptive to pass something like 'GetRandom random number generation').</p>
<p>The second argument passed is a function that acts as the body of the test. It starts with an <code>it</code> function which, similar to the <code>describe</code> function, describes the test. Here, we give a small description of the functionality we are testing, or what the expected functionality is. The second argument is another function, and in this function we can actually write our test code.</p>
<p>In this example, we are using the <code>assert</code> assertion style, but Chai offers other styles of assertion, such as <code>should</code> or <code>expect</code>. You can find out the differences between them in the <a href="https://www.chaijs.com/guide/styles/">Chai Assertion Styles Guide.</a></p>
<p>When this test is run, our <code>getRandom</code> function is called, and the test makes assertions on the result. We assert (verify) that the returned result (<code>random</code>) is not null, is a number, and is at least 0, but no more than 100. If all these assertions pass, that means our code is functioning as it is supposed to, and our unit passed it's unit test.</p>
<h3>Integration Tests</h3>
<p>Testing the functionality of our API endpoint constitutes an integration test as we are testing how all the individual parts of our program work together to send a response back when our <code>/random</code> endpoint is hit. In order to do this, we need to use <code>chai-http</code>. This package allows us to make HTTP requests to our server during tests.</p>
<p>Because of the use of asynchronous code and promises in the implementation of this functionality, we have to approach the integration test for this code slightly differently. We pass a callback inside the <code>it</code> function that calls and tests our asynchronous code (same as before).</p>
<script src="https://gist.github.com/elletownsend/b23100a01741d4bd099cceee20d160a1.js"></script>
<p><code>chai-http</code> allows us to construct a request to our application by passing in our app. This automatically opens our server for incoming requests. We can then use¬†<code>.get()</code> to call our <code>/random</code> endpoint. The <code>end</code> method is then used to make the request and assert on the response.</p>
<p>Because the <code>end</code> functions is a callback, we have to use the <code>done</code> callback in order to indicate to Mocha that our callback has completed and the assertions are ready to be verified. If we don't do this, the test will pass before the assertions are checked.</p>
<p>We check that our response contains a successful status code, and that the number that the response returns is not null, is a number, and is at least 0 but no bigger than 100 (no change there).</p>
<p>In this integration test, we are making sure that not only are we provided with the response from the API endpoint that we are expecting, but we are also making sure that our API as a whole behaves as expected when responding to a GET request. This is testing how multiple 'units' of our application come together to provide this functionality.</p>
<hr>
<p>And that's it! We have completed a unit and an integration test for our mini-API.</p>
<p>While this is a simplified example, you can use these as a template to go on and test your own, more in-depth Node &amp; Express projects. The implementation remains the same, but you can develop these example tests further and duplicate them in order to test larger and more complex programs.</p>
<p>Below I have linked to some other great guides on unit &amp; integration testing in Node.js, as well as the official documentation for Mocha &amp; Chai. Happy testing!</p>
<hr>
<h2>Resources</h2>
<ul>
<li>Unit Testing in Node.js with Mocha &amp; Chai - <a href="https://livecodestream.dev/post/testing-in-nodejs-using-mocha-and-chai-part-1/">https://livecodestream.dev/post/testing-in-nodejs-using-mocha-and-chai-part-1/</a></li>
<li>Integration Testing in Node.js with Mocha &amp; Chai - <a href="https://livecodestream.dev/post/testing-in-nodejs-using-mocha-and-chai-part-2/">https://livecodestream.dev/post/testing-in-nodejs-using-mocha-and-chai-part-2/</a></li>
<li>JavaScript Testing with Mocha &amp; Chai - <a href="https://codeburst.io/javascript-unit-testing-using-mocha-and-chai-1d97d9f18e71">https://codeburst.io/javascript-unit-testing-using-mocha-and-chai-1d97d9f18e71</a></li>
<li>Unit &amp; Integration Testing for Node.js - <a href="https://blog.logrocket.com/unit-and-integration-testing-for-node-js-apps/">https://blog.logrocket.com/unit-and-integration-testing-for-node-js-apps/</a></li>
<li>Mocha - <a href="https://mochajs.org">https://mochajs.org</a></li>
<li>Chai - <a href="https://www.chaijs.com">https://www.chaijs.com</a></li>
<li>Chai-http - <a href="https://www.chaijs.com/plugins/chai-http/">https://www.chaijs.com/plugins/chai-http/</a></li>
</ul>

        </div>
        <div class="footer">
            <div class="footer_tags">
                
                <span class="footer_tag">
                    Tech
                </span>
                
                <span class="footer_tag">
                    APIs
                </span>
                
                <span class="footer_tag">
                    Coding
                </span>
                
            </div>
            <hr>
            <h2 class="footer_title">a post by elle townsend.</h2>
            <p class="footer_bio">
                A Software Engineer with a love of all things tech, writing about professional (and personal) development, Women In Tech, and coding.
            </p>
        </div>
        <button onclick="topFunction()" class="topBtn" id="topBtn" title="Go to top"><i class="fas fa-arrow-up"></i></button>
        <!-- footer -->
    </main>
    <script src="/js/main.js"></script>
</body>

</html>